<!--NAVBAR-->
<nav class="navbar navbar-expand-lg navbar-dark nav-bar">
    <a class="navbar-brand" href="/">
        <img src="/img/regsol.png" width="180" height="65" />
    </a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="inicioID();">Inicio</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="regID();">Registrar</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" href="#" onclick="gesID();">Gestionar</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" onclick="infoID();">Informe</a>
            </li>
        </ul>
    </div>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto"></ul>
        <form class="form-inline my-2 my-lg-0">
            <ul class="navbar-nav mr-auto">
                        <div class="containerProfile">
            <img class="profileIMG" src="/img/user_bg.png" />
            <div id="userProfile" class="centered"></div>
        </div>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userlink" role="button" data-toggle="dropdown"
                        aria-expanded="false">
                        Usuario
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                                    <a class="dropdown-item" href="#" onclick="perfilID();">Perfil</a>
                    </div>
                </li>

                <li class="nav-item mx-1">
                    <a id="signoutlink" class="nav-link" href="">Cerrar Sesión</a>
                </li>
            </ul>
        </form>
    </div>
    </div>
</nav>

<!--VALIDACION MANAGE-->
<div id="alertGest" style="text-align: center" class="alert alert-info displayNone">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  Solicitud <strong>Gestionada</strong>
</div>

<!--VALIDACION AUTH-->
<div id="alertAut" style="text-align: center" class="alert alert-success displayNone">
  <button type="button" class="close" data-dismiss="alert">&times;</button>
  Solicitud <strong>Autorizada</strong>
</div>

<!--DATA SERVICE-->
<input id="idSolSelectDataGes" name="idSolSelectDataGes" style="display: none;">
<input id="idSolSelectDataAut" name="idSolSelectDataAut" style="display: none;">
<input id="AutEmailSolData" name="AutEmailSolData" style="display: none;">
<input id="SessEmailData" name="SessEmailData" style="display: none;">
<input id="UIDSess" name="UIDSess" style="display: none;" value="{{UIDSess}}">
<input id="areaUserGes" name="areaUserGes" style="display: none;" value="{{areaUserGes}}">

<!-- MODAL AYUDA -->
<div class="modal fade" id="ayudaModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="gridModalLabel">Ayuda sobre la Gestión</h5>
                <button type="button" class="close" data-dismiss="modal"><span>×</span></button>
            </div>
            <div class="modal-body">
                <div class="container-fluid bd-example-row">
                    <p class="row text-justify font-weight-light">
                        {{AyudaGestionar}}
                    </p>
                    <br>
                    <div class="row float-right">
                        <a class="navbar-brand">
                            <img src="/img/regsol.png" width="140px" height="50,5px" />
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--DATA SOLICITUDES -->
<div class="rowregsol">
    <div class="mt-3 ml-3 areaform">

        <a type="button" id="btnAyudaSol" class="btn btn-primary ml-2 float-right" data-toggle="modal"
            data-target="#ayudaModal" title="Ayuda">
            <i class="fa fa-question-circle"></i>
        </a>

        <div class="form-group">

            <a id="btnGesSol" name="btnGesSol" class="btn btn-primary text-white float-right" href="#"
                onclick="gestionID();" title="Gestionar">
                <i class="fa fa-cogs"></i>
            </a>
            {{#if SolReg3}}
            <a id="btnAutSol" name="btnAutSol" class="btn btn-primary text-white mr-2 float-right" data-toggle="modal"
                data-target="#autModal" title="Autorizar">
                <i class="fa fa-handshake-o"></i>
            </a>
            {{/if}}
        </div>

        <p style="color: #ffffff;" class="col-6">
            <i class="fa fa-angle-double-right" style="color: #d41b3b;"></i>&nbsp;<b>SOLICITUDES EMITIDAS</b>
        </p>

        <div class="rowges">
            <!--SELECT-->
            <div class="areaformges">
                <div class="table-wrapper-scroll-y my-custom-scrollbar-ges">
                    <table id="soltable" class="table table-sm table-condensed tableFixHead">
                        <thead style="background-color:rgb(255, 255, 255)">
                            <tr>
                                <th class="col-xs-2">ID</th>
                                <th class="col-xs-2">TIPO</th>
                                <th class="col-xs-5">ASUNTO</th>
                                <th class="col-xs-3">PARA</th>
                                <th class="col-xs-2">FECHA</th>
                                <th class="col-xs-2">ESTADO</th>
                                <th class="col-xs-2"><i class="fa fa-product-hunt"></i></th>
                                <th class="col-xs-2 text-center"><i class="fa fa-handshake-o"></i></th>
                                <th class="col-xs-2">RESPUESTA</th>
                            </tr>
                        </thead>
                        {{#each SolReg1}}
                        <tbody>
                            <tr class="clickableRow">
                                <td class="col-xs-2">{{inpIDSol}}</td>
                                <td class="col-xs-2">{{inpTipoSol}}</td>
                                <td class="col-xs-5">{{inpAsunSol}}</td>
                                <td class="col-xs-3">{{inpNomRecepSol}}</td>
                                <td class="col-xs-2">{{inpFechaSol}}</td>
                                <td class="col-xs-2">{{inpEstadoSol}}</td>

                                <td class="col-xs-2">
                                <img id="IMGpriori" src="{{imgPrioriSrc}}" width="18" height="18" />
                                <input id="inpPrioridadSol" value="{{inpPrioridadSol}}" style="display: none;">
                                </td>
                    
                                {{#if inpAutEmailSol}}
                                <td class="col-xs-2 text-center"><i class="fa fa-user"></td>
                                {{else}}
                                <td class="col-xs-2"></td>
                                {{/if}}

                                <td class="col-xs-2">{{AutResponse}}</td>

                                <td class="data1" id="idSolSelect" style="display: none;">
                                    <span>{{uidSol}}</span>
                                </td>
                            </tr>
                        </tbody>
                        {{/each}}
                    </table>
                </div>
            </div>

            <p style="color: #ffffff;" class="col-6 mt-4">
                <i class="fa fa-angle-double-left" style="color: #d41b3b;"></i>&nbsp;<b>SOLICITUDES RECIBIDAS</b>
            </p>
            <!--SELECT-->
            <div class="areaformges">
                <div class="table-wrapper-scroll-y my-custom-scrollbar-ges">
                    <table id="soltable" class="table table-sm table-condensed tableFixHead">
                        <thead style="background-color:rgb(255, 255, 255)">
                            <tr>
                                <th class="col-xs-2">ID</th>
                                <th class="col-xs-2">TIPO</th>
                                <th class="col-xs-5">ASUNTO</th>
                                <th class="col-xs-3">DE</th>
                                <th class="col-xs-2">FECHA</th>
                                <th class="col-xs-2">ESTADO</th>
                                <th class="col-xs-2" title="Prioridad"><i class="fa fa-product-hunt"></i></th>
                                <th class="col-xs-2 text-center" title="Autorizar"><i class="fa fa-handshake-o"></i></th>
                                <th class="col-xs-2">RESPUESTA</th>
                                
                            </tr>
                        </thead>
                        {{#each SolReg2}}
                        <tbody>
                            <tr class="clickableRow">
                                <td class="col-xs-2">{{inpIDSol}}</td>
                                <td class="col-xs-2">{{inpTipoSol}}</td>
                                <td class="col-xs-5">{{inpAsunSol}}</td>
                                <td class="col-xs-3">{{inpEmailSol}}</td>
                                <td class="col-xs-2">{{inpFechaSol}}</td>
                                <td class="col-xs-2">{{inpEstadoSol}}</td>
                                
                                <td class="col-xs-2">
                                    <img id="IMGpriori" src="{{imgPrioriSrc}}" width="18" height="18" />
                                    <input id="inpPrioridadSol" value="{{inpPrioridadSol}}" style="display: none;">
                                </td>

                                {{#if inpAutEmailSol}}
                                <td class="col-xs-2 text-center"><i class="fa fa-user"></td>
                                {{else}}
                                <td class="col-xs-2"></td>
                                {{/if}}

                                <td class="col-xs-2">{{AutResponse}}</td>



                                <td class="data1" id="idSolSelect" style="display: none;">
                                    <span>{{uidSol}}</span>
                                </td>
                            </tr>
                        </tbody>
                        {{/each}}
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MODAL AUTORIZAR -->
<div class="modal fade" id="autModal" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-body">
                <a type="button" class="close" data-dismiss="modal"><span>x</span></a>
                <div class="rowregsol">
                    <div class="areaform4">
                        <a id="btnAutSol" name="btnAutSol" class="btn btn-primary text-white float-right mr-3" href="#"
                            onclick="autorizarID();" title="Autorizar"><i class="fa fa-pencil-square-o"></i>
                        </a>
                        <p style="color: #ffffff;" class="col-6 mt-2">
                            <i class="fa fa-user-circle"></i>&nbsp;<b>AUTORIZAR SOLICITUDES</b>
                        </p>
                        <div class="rowges">
                            <!--SELECT-->
                            <div class="areaformges">
                                <div class="table-wrapper-scroll-y my-custom-scrollbar-ges">

                                    <table id="auttable" class="table table-sm table-condensed tableFixHead">
                                        <thead style="background-color:rgb(255, 255, 255)">
                                            <tr>
                                                <th class="col-xs-2">ID</th>
                                                <th class="col-xs-2">TIPO</th>
                                                <th class="col-xs-5">ASUNTO</th>
                                                <th class="col-xs-3">DE</th>
                                                <th class="col-xs-3">PARA</th>
                                                <th class="col-xs-2">FECHA</th>
                                                <th class="col-xs-2">RESPUESTA</th>
                                                <th class="col-xs-2"><i class="fa fa-product-hunt"></i></th>
                                            </tr>
                                        </thead>
                                        {{#each SolReg3}}
                                        <tbody>
                                            <tr class="clickableRow">
                                                <td class="col-xs-2">{{inpIDSol}}</td>
                                                <td class="col-xs-2">{{inpTipoSol}}</td>
                                                <td class="col-xs-5">{{inpAsunSol}}</td>
                                                <td class="col-xs-3">{{inpNomSol}}</td>
                                                <td class="col-xs-3">{{inpNomRecepSol}}</td>
                                                <td class="col-xs-2">{{inpFechaSol}}</td>
                                                <td class="col-xs-2">{{AutResponse}}</td>
                                                <td class="col-xs-2">
                                                    <img id="IMGpriori" src="{{imgPrioriSrc}}" width="18" height="18" />
                                                    <input id="inpPrioridadSol" value="{{inpPrioridadSol}}"
                                                        style="display: none;">
                                                </td>
                                                <td class="data2" id="idSolSelect" style="display: none;">
                                                    <span>{{uidSol}}</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                        {{/each}}
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!--SCRIPTS-->
    <script type="module" src="/./js/ges.js"></script>

    <script>
    const firebase = sessionStorage.getItem("user");
    const userlog = (JSON.parse(firebase));
    const uid = userlog.uid;

    function perfilID() {
        window.location.href = "/perfil/" + uid;
    }
    function regID() {
        window.location.href = "/reg/" + uid + "/" + "data";
    }
    function gesID() {
        window.location.href = "/ges/" + uid + "/" + "data";
    }
    function inicioID() {
        window.location.href = "/inicio/" + uid;
    }
    function gestionID() {
        if (idSolSelectDataGes.value == "") {
            swal("Advertencia!", "Selecciona una solicitud de gestión para continuar.", "warning", {
                buttons: { Ok: true },
            })
        } else {
            window.location.href = "/gestionar/" + UIDSess.value + "/" + idSolSelectDataGes.value;
        }
    }
    function autorizarID() {
        if (idSolSelectDataAut.value == "") {
            swal("Advertencia!", "Selecciona una solicitud de autorización para continuar.", "warning", {
                buttons: { Ok: true },
            })
        } else {
            window.location.href = "/autorizar/" + UIDSess.value + "/" + idSolSelectDataAut.value;
        }
    }
    function infoID() {
        window.location.href = "/info/" + uid;
    }
    </script>